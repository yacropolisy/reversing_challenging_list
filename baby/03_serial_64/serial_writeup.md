# serial

jmp 命令で変なところに飛んでいるため、IDAではそのままではアセンブリ言語をみることが出来ない。

なんか使ったら見れるのかもしれないけど、gdb-pedaでjmpについていきながらコードを見ていけばOK。

リバースエンジニアリングバイブルにこういう問題が載ってた気がする。



`gdb serial` でgdb-pedaを起動し、`start` `ni` `nextcall` `x` `b` `c` などのコマンドを用いて解析する。

`start` でプログラムを動かし、`ni` でステップ実行、`nextcall` で次の`call` までスキップ。

`b *アドレス` でそのアドレスにブレークポイントを設定、`c` でブレークポイントまでスキップ。

`x/10i *アドレス` で そのアドレスから10個命令を表示できる。



プログラムを解析すると、初めに`call   0x400860` でユーザの入力を受け付け、以下の`strlen` で文字数が16となっているかチェック。

```
=> 0x400a23 <main+135>:	call   0x400850 <strlen@plt>
   0x400a28 <main+140>:	cmp    rax,0x10
   0x400a2c <main+144>:	je     0x400a3c <main+160>
```

その後は、1文字目が 0x45 (ASCIIで `E` )となっているかチェック -> 16文字目と1文字目の和が 0x9b となっているかチェック

2文字目が 0x5a となっているかチェック -> 15文字目と2文字目の和が 0x9b となっているかチェック

3文字目と14文字目

.

.

.

となっている。それぞれのASCIIコードを計算し、エンコードすればFlagゲット。